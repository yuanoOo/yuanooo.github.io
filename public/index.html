<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>破晓 - 日拱一卒，功不唐捐</title><meta name="keywords" content="个人博客、Code、学习、linux、大数据、java、flink"><meta name="author" content="破晓"><meta name="copyright" content="破晓"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="referrer" content="no-referrer"><meta name="description" content="日拱一卒，功不唐捐">
<meta property="og:type" content="website">
<meta property="og:title" content="破晓">
<meta property="og:url" content="https://poxiao.tk/index.html">
<meta property="og:site_name" content="破晓">
<meta property="og:description" content="日拱一卒，功不唐捐">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://poxiao.tk/img/bg/avatar.webp">
<meta property="article:author" content="破晓">
<meta property="article:tag" content="个人博客、Code、学习、linux、大数据、java、flink">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://poxiao.tk/img/bg/avatar.webp"><link rel="shortcut icon" href="/img/bg/avatar.webp"><link rel="canonical" href="https://poxiao.tk/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="v7W8T1yBsImqvya-nz126O5wJTmGsQyUQJ_F8vmgUVU"/><meta name="baidu-site-verification" content="code-0Fs0BLUCMV"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: 'ca-pub-6838336925474374',
  enable_page_level_ads: 'true'
});</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-NDZBTJH9W4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-NDZBTJH9W4');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: 破晓","link":"链接: ","source":"来源: 破晓","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '破晓',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2023-09-27 19:26:29'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.2.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/bg/avatar.webp" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">58</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">41</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">30</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('/img/bg/banner.gif')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">破晓</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">破晓</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/Leopard" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:sssbbbb@gmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover right"><a href="/posts/7631.html" title="利用RuntimeReplaceable实现Spark Native function"><img class="post_bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zfh-tuchuang.oss-cn-shanghai.aliyuncs.com/img/site-backgound.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="利用RuntimeReplaceable实现Spark Native function"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/7631.html" title="利用RuntimeReplaceable实现Spark Native function">利用RuntimeReplaceable实现Spark Native function</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-09-27T07:55:27.000Z" title="发表于 2023-09-27 15:55:27">2023-09-27</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/bigdata/">bigdata</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/bigdata/spark/">spark</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/spark/">spark</a></span></div><div class="content">关于Spark Native Function在Spark中实现自定义函数，有多种方式：

1、实现Hive UDF，Spark是兼容Hive UDF的，简单易用，支持纯SQL环境，因此这可能是使用最为广泛的。
2、实现Spark-SQL UDF，需要嵌入到代码中，因此也主要用在代码中，目前还不支持纯SQL环境。
3、通过拓展SparkSessionExtensions，基本等价于Spark Built-in内置函数，可以充分利用Spark catalyst优化器和Codegen，从而带来可观的性能提升，这里称之为Spark Native Function。但是这种方式也是实现最为困难的，需要对SQL解析器、优化器等有一定的理解。同时网上关于这种方式的资料几乎没有，Spark官方文档中也是根本没有提及这种方式，足以说明这种方式较高的门槛。

应用场景：RuntimeReplaceableSpark已经内置足够多的UDF，已经可以满足绝大部分的应用场景。
剩下的不能满足的应用场景中，其中很大一部分可以通过组合这些内置的函数，来满足。因此也就带来一个问题，就是有时候应用场景非常复杂，需要组 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/55672.html" title="DAG实现与任务调度"><img class="post_bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dogefs.s3.ladydaily.com/tzk/storage/20210302234030.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DAG实现与任务调度"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/55672.html" title="DAG实现与任务调度">DAG实现与任务调度</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-08-30T10:45:16.000Z" title="发表于 2023-08-30 18:45:16">2023-08-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/data-structure/">data-structure</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/DAG/">DAG</a></span></div><div class="content">前言在任务调度场景中，常常通过DAG将多个任务编排成一个复杂的Job，进而满足复杂的任务调度应用场景。特别是在大数据领域，这类调度系统是必须的，比如Azkaba、DolphinScheduler、AirFlow…。而这些系统正是通过DAG进行任务编排的，那么下面让我们试着简单的实现一个DAG调度程序。
Code1、抽象出一个任务执行接口123public interface Executor &#123;    boolean execute();&#125;



2、简单实现一个示例Task，需实现Executor接口。12345678910111213141516171819202122232425262728293031public class Task implements Executor&#123;    private Long id;    private String name;    private int state;    public Task(Long id, String name, int state) &#123;        this.id =  ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/5296.html" title="优化Flink ogg-json format"><img class="post_bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zfh-tuchuang.oss-cn-shanghai.aliyuncs.com/img/site-backgound.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="优化Flink ogg-json format"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/5296.html" title="优化Flink ogg-json format">优化Flink ogg-json format</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-08-08T12:23:04.000Z" title="发表于 2023-08-08 20:23:04">2023-08-08</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/bigdata/">bigdata</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/bigdata/Flink/">Flink</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Flink/">Flink</a></span></div><div class="content">前言最近发现从kafka同步到Paimon中的数据不正确。具体表现为，明明数据库中某条记录已经Update了，但是Paimon中的同一条记录没有同步更新。经过一系列的排查发现，是由于公司ogg json格式不统一，导致Flink ogg-json format解析失败，同时因为配置了ogg-json.ignore-parse-errors = true，最终导致整条ogg更新Record被丢弃，没有发送到下流的Paimon。
代码记录org.apache.flink.formats.json.ogg.OggJsonDeserializationSchema#deserialize(byte[], org.apache.flink.util.Collector&lt;org.apache.flink.table.data.RowData&gt;)
1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253@Overridepublic void dese ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/6282.html" title="DolphinScheduler RPC框架源码分析"><img class="post_bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zfh-tuchuang.oss-cn-shanghai.aliyuncs.com/img/site-backgound.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DolphinScheduler RPC框架源码分析"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/6282.html" title="DolphinScheduler RPC框架源码分析">DolphinScheduler RPC框架源码分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-07-09T13:07:13.000Z" title="发表于 2023-07-09 21:07:13">2023-07-09</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/RPC/">RPC</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/dolphinscheduler/">dolphinscheduler</a></span></div><div class="content">前言截至2023-07-09，DolphinScheduler3.x最新版本Dev分支，DolphinScheduler中虽然基于Netty实现了一个简单的RPC框架，但是并没有使用，或者说使用的不是完整版的RPC框架。其中大量直接使用Netty Client发送网络请求，并没有使用动态代理简化或或者说屏蔽掉通信细节，虽然在org.apache.dolphinscheduler.rpc包中已经有了完整实现。
本文主要分析org.apache.dolphinscheduler.rpc包中完整的RPC实现。虽然在DolphinScheduler中没有被使用，但是代码是共通的。
源码分析Rpc通信协议Protocol定义在org.apache.dolphinscheduler.rpc.protocol.MessageHeader类中，没有什么好说的，差不多的套路。

一字节的version
一字节的eventType：HEARTBEAT、REQUEST、RESPONSE
四字节的msgLength
……
一字节的serialization类型：dolphinscheduler目前实现了一种基 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/24799.html" title="Paimon动态Bucket设计与实现"><img class="post_bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dogefs.s3.ladydaily.com/tzk/storage/000651627f0c-92aec253754ab3dba99f61b49e9aa856.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Paimon动态Bucket设计与实现"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/24799.html" title="Paimon动态Bucket设计与实现">Paimon动态Bucket设计与实现</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-06-21T09:57:25.000Z" title="发表于 2023-06-21 17:57:25">2023-06-21</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/bigdata/">bigdata</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/bigdata/paimon/">paimon</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/paimon/">paimon</a></span></div><div class="content">前言Paimon Dynamic Bucket是Paimon-0.5引入的新特性，现在Paimon可以动态的创建Bucket进行扩容，旨在进一步简化了创建Paimon表的过程，用户无需关心需要创建多少个Bucket。通过dynamic-bucket.target-row-num配置指定每个桶存储多少条记录，默认是2_000_000L。
为了实现这个特性，Paimon需要利用文件记录所有Record与其Bucket的映射关系。在paimon中，使用Record的主键的hashcode代表一个Record，而hashcode是Int类型，减少了内存占用。使用主键的hashcode代表一个Record还有一个好处就是，使用int就可以覆盖所有的Record，即使dynamic-bucket.target-row-num是Long类型，避免了空间无限膨胀的问题。这是因为即使hash冲突，并不影响正确性。
通过不断检查映射文件中key的行数，当大于dynamic-bucket.target-row-num时，创建新的bucket进行扩容。
设计与实现实现集中在paimon-core&#x2F;s ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/26343.html" title="Spark Batch Read Paimon源码分析"><img class="post_bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zfh-tuchuang.oss-cn-shanghai.aliyuncs.com/img/site-backgound.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Spark Batch Read Paimon源码分析"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/26343.html" title="Spark Batch Read Paimon源码分析">Spark Batch Read Paimon源码分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-06-21T09:57:25.000Z" title="发表于 2023-06-21 17:57:25">2023-06-21</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/bigdata/">bigdata</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/bigdata/paimon/">paimon</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/paimon/">paimon</a></span></div><div class="content">
A bucket is the smallest storage unit for reads and writes, so the number of buckets limits the maximum processing parallelism. This number should not be too big, though, as it will result in lots of small files and low read performance. In general, the recommended data size in each bucket is about 1GB.



num-sorted-run.compaction-trigger
5
Integer
The sorted run number to trigger compaction. Includes level0 files (one file one sorted run) and high-level runs (one level one sorted run).




Pa ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/3025.html" title="修复dolphinscheduler Hive SQL数据源连接Kyuubi偶现Read timed out错误"><img class="post_bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dogefs.s3.ladydaily.com/tzk/storage/20210302234030.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="修复dolphinscheduler Hive SQL数据源连接Kyuubi偶现Read timed out错误"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/3025.html" title="修复dolphinscheduler Hive SQL数据源连接Kyuubi偶现Read timed out错误">修复dolphinscheduler Hive SQL数据源连接Kyuubi偶现Read timed out错误</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-06-14T09:57:25.000Z" title="发表于 2023-06-14 17:57:25">2023-06-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Troubleshooting/">Troubleshooting</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/dolphinscheduler/">dolphinscheduler</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/Troubleshooting/">Troubleshooting</a></span></div><div class="content">前言dolphinscheduler中利用Hive SQL数据源连接Kyuubi偶现Read timed out错误，错误日志如下：
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354[ERROR] 2023-06-08 17:39:06.166 +0800 - Task execute failed, due to meet an exceptionorg.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:168)	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerDelayTaskExecuteRunna ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/10009.html" title="记一次大量TCP连接CLOSE_WAIT问题排查"><img class="post_bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zfh-tuchuang.oss-cn-shanghai.aliyuncs.com/img/site-backgound.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="记一次大量TCP连接CLOSE_WAIT问题排查"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/10009.html" title="记一次大量TCP连接CLOSE_WAIT问题排查">记一次大量TCP连接CLOSE_WAIT问题排查</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-06-11T09:57:25.000Z" title="发表于 2023-06-11 17:57:25">2023-06-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Troubleshooting/">Troubleshooting</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Troubleshooting/">Troubleshooting</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/paimon/">paimon</a></span></div><div class="content">问题今天突然发现Spark SQL任务启动不起来，报下面的错误，&#39;org.apache.spark.network.netty.NettyBlockTransferService&#39; could not bind on a random free port. You may check whether configuring an appropriate binding address. 2023-05-18 13:57:40,952 WARN util.Utils: Service，看到这段日志后，表明服务器大量端口被占用，Spark申请不到端口，尝试了100次后，抛出了下面的异常。
1234567891011121314151617181920212220/12/21 12:55:18 WARN Utils: Service &#x27;org.apache.spark.network.netty.NettyBlockTransferService&#x27; could not bind on a random free port. You may check wh ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/17536.html" title="初识Apache Druid"><img class="post_bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dogefs.s3.ladydaily.com/tzk/storage/000651627f0c-92aec253754ab3dba99f61b49e9aa856.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="初识Apache Druid"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/17536.html" title="初识Apache Druid">初识Apache Druid</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-06-11T09:57:25.000Z" title="发表于 2023-06-11 17:57:25">2023-06-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Druid/">Druid</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Druid/">Druid</a></span></div><div class="content">Why Druid
OLAP 是一种让用户可以用从不同视角方便快捷的分析数据的计算方法。主流的 OLAP 可以分为3类：多维 MOLAP ( Multi-dimensional OLAP )、关系型 ROLAP ( Relational OLAP ) 和混合 HOLAP ( Hybrid OLAP ) 三大类。

在海量数据上进行亚秒级的多维分析，并且要求高并发，可以选择的OLAP系统并不多。而其中MOLAP最为知名的就是Apache Kylin和Apache Druid。
先前我们一直采用Apache Kylin进行离线多维分析，在使用中发现了一系列问题，让我们不得不将目光放在Druid上面：

1、由于Kylin构建cube的数量和维度的关系是2的n次方，指数级增长是非常可怕的，一般超过20个维度，在Kylin中就要小心了，因此使用Kylin需要时刻担心维度爆炸的问题。
2、Kylin目前要求不超过63个Normal维度，这是因为cubeid是Long类型，而Long的最大值是2^63 -1，所以不能超过63个维度。而我们的业务场景最大会有二百多个维度，Kylin已经不满足我们的要 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/27532.html" title="Paimon-Flink-Sink源码分析"><img class="post_bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dogefs.s3.ladydaily.com/tzk/storage/20210302234030.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Paimon-Flink-Sink源码分析"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/27532.html" title="Paimon-Flink-Sink源码分析">Paimon-Flink-Sink源码分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-05-24T09:57:25.000Z" title="发表于 2023-05-24 17:57:25">2023-05-24</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/bigdata/">bigdata</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/bigdata/paimon/">paimon</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/paimon/">paimon</a></span></div><div class="content">前言Paimon在Flink下面的层次结构，大概为：Catalog -&gt; Database -&gt; Table -&gt; Record。因此看Paimon如何在Flink中实现Read、Write等操作，先从Catalog开始。
CatalogPaimon在Flink中实现Catalog的源码位于org.apache.paimon.flink.FlinkCatalog，该类实现了org.apache.flink.table.catalog.Catalog接口。该接口中定义了一系列方法，包括listTables、listViews等方法，而paimon一一实现了这些接口。
在Flink中自定义Catalog，还需要实现org.apache.flink.table.factories.CatalogFactory工厂接口，paimon中对应的为org.apache.paimon.flink.FlinkCatalogFactory类。该工厂类当然是用来创建Catalog了。
最后还需要将Catalog工厂实现类，添加到将此实现类添加到 META_INF/services/org. ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/#content-inner">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/#content-inner">6</a><a class="extend next" rel="next" href="/page/2/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/bg/avatar.webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">破晓</div><div class="author-info__description">日拱一卒，功不唐捐</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">58</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">41</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">30</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Leopard" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:sssbbbb@gmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/dns/" style="font-size: 1.15em; color: rgb(137, 120, 92)">dns</a><a href="/tags/CDN/" style="font-size: 1.15em; color: rgb(147, 155, 190)">CDN</a><a href="/tags/hexo/" style="font-size: 1.35em; color: rgb(86, 32, 141)">hexo</a><a href="/tags/cloudflare/" style="font-size: 1.15em; color: rgb(39, 25, 174)">cloudflare</a><a href="/tags/SEO/" style="font-size: 1.15em; color: rgb(28, 134, 36)">SEO</a><a href="/tags/WSL/" style="font-size: 1.15em; color: rgb(42, 0, 64)">WSL</a><a href="/tags/Linxu/" style="font-size: 1.15em; color: rgb(73, 3, 174)">Linxu</a><a href="/tags/github-pages/" style="font-size: 1.15em; color: rgb(51, 188, 19)">github pages</a><a href="/tags/CFW/" style="font-size: 1.15em; color: rgb(103, 184, 133)">CFW</a><a href="/tags/BugFix/" style="font-size: 1.15em; color: rgb(47, 29, 96)">BugFix</a><a href="/tags/PR/" style="font-size: 1.15em; color: rgb(111, 6, 70)">PR</a><a href="/tags/Doris/" style="font-size: 1.45em; color: rgb(80, 145, 112)">Doris</a><a href="/tags/%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0/" style="font-size: 1.15em; color: rgb(55, 64, 0)">数据中台</a><a href="/tags/HBase/" style="font-size: 1.15em; color: rgb(93, 186, 190)">HBase</a><a href="/tags/MVCC/" style="font-size: 1.15em; color: rgb(94, 21, 27)">MVCC</a><a href="/tags/Kyuubi/" style="font-size: 1.15em; color: rgb(161, 113, 52)">Kyuubi</a><a href="/tags/yarn/" style="font-size: 1.15em; color: rgb(6, 57, 90)">yarn</a><a href="/tags/hadoop/" style="font-size: 1.15em; color: rgb(84, 187, 14)">hadoop</a><a href="/tags/kudu/" style="font-size: 1.15em; color: rgb(22, 169, 41)">kudu</a><a href="/tags/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F/" style="font-size: 1.15em; color: rgb(46, 178, 200)">用户画像</a><a href="/tags/DAG/" style="font-size: 1.15em; color: rgb(132, 3, 64)">DAG</a><a href="/tags/LSM-Tree/" style="font-size: 1.15em; color: rgb(92, 113, 169)">LSM-Tree</a><a href="/tags/Threads/" style="font-size: 1.15em; color: rgb(157, 133, 9)">Threads</a><a href="/tags/Netty/" style="font-size: 1.2em; color: rgb(140, 158, 196)">Netty</a><a href="/tags/os/" style="font-size: 1.2em; color: rgb(96, 43, 78)">os</a><a href="/tags/dolphinscheduler/" style="font-size: 1.2em; color: rgb(59, 76, 28)">dolphinscheduler</a><a href="/tags/thrift/" style="font-size: 1.15em; color: rgb(176, 199, 106)">thrift</a><a href="/tags/RPC/" style="font-size: 1.15em; color: rgb(73, 29, 29)">RPC</a><a href="/tags/Troubleshooting/" style="font-size: 1.3em; color: rgb(101, 103, 174)">Troubleshooting</a><a href="/tags/paimon/" style="font-size: 1.3em; color: rgb(61, 63, 182)">paimon</a><a href="/tags/Kylin/" style="font-size: 1.2em; color: rgb(59, 159, 3)">Kylin</a><a href="/tags/JVM/" style="font-size: 1.15em; color: rgb(146, 148, 127)">JVM</a><a href="/tags/MAT/" style="font-size: 1.15em; color: rgb(75, 131, 12)">MAT</a><a href="/tags/Arthas/" style="font-size: 1.15em; color: rgb(102, 72, 163)">Arthas</a><a href="/tags/Flink/" style="font-size: 1.4em; color: rgb(155, 31, 174)">Flink</a><a href="/tags/Hudi/" style="font-size: 1.15em; color: rgb(108, 97, 108)">Hudi</a><a href="/tags/Druid/" style="font-size: 1.15em; color: rgb(74, 71, 155)">Druid</a><a href="/tags/LSM/" style="font-size: 1.15em; color: rgb(27, 32, 54)">LSM</a><a href="/tags/scala/" style="font-size: 1.15em; color: rgb(56, 71, 108)">scala</a><a href="/tags/spark/" style="font-size: 1.25em; color: rgb(2, 118, 199)">spark</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/09/"><span class="card-archive-list-date">九月 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/08/"><span class="card-archive-list-date">八月 2023</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/07/"><span class="card-archive-list-date">七月 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/06/"><span class="card-archive-list-date">六月 2023</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/05/"><span class="card-archive-list-date">五月 2023</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/04/"><span class="card-archive-list-date">四月 2023</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/03/"><span class="card-archive-list-date">三月 2023</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/02/"><span class="card-archive-list-date">二月 2023</span><span class="card-archive-list-count">1</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">58</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2020-06-06T16:00:00.000Z"></div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">81.5k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2023-09-27T11:26:28.523Z"></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By 破晓</div><div class="footer_custom_text">VARIETY IS THE SPICE OF LIFE. POWERED BY HEXO WITH BUTTERFLY</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>function subtitleType () {
  getScript('https://sdk.jinrishici.com/v2/browser/jinrishici.js').then(() => {
    jinrishici.load(result =>{
      if (false) {
        const sub = ["今日事&#44;今日毕","Never put off till tomorrow what you can do today"]
        const content = result.data.content
        sub.unshift(content)
        window.typed = new Typed('#subtitle', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: false,
          backSpeed: 50,
        })
      } else {
        document.getElementById('subtitle').innerHTML = result.data.content
      }
    })
  })
}

if (false) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock_anzhiyu')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var qweather_key = 'b16a1fa0e63c46a4b8f28abfb06ae3fe';
  var gaud_map_key = 'e2b04289e870b005374ee030148d64fd&s=rsv3';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '112.982279,28.19409';
  var clock_default_rectangle_enable = 'false';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><!-- hexo injector body_end end --></body></html>